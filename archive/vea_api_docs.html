<!DOCTYPE html>
<html>
  <head>
    <title>Vea API Documentation</title>
    <link rel="stylesheet" href="//unpkg.com/swagger-ui-dist@3.30.0/swagger-ui.css" />
    <link rel="stylesheet" href="style.css" />
  </head>

  <body>
    <div class="auth-instructions">
      <h3>Vea API Documentation</h3>
      <p>
        Below you will find documentation to query the Vea API and retrieve data from your sensors.
      </p>
      <p>
        To test queries, you'll need to have a valid Vea account and API credentials. Once you have those,
        you can follow <span class="instructions" onclick="javascript:openModal()">these instructions</span> to temporarily authorize this page and allow you to
        make API calls.
      </p>
      <p>
        Before moving on to testing the API, you will want to review <a class="instructions" href="Vea-API-Example.pdf">this guide</a> to see a concrete example of authentication
        with the API and using the access token to make API calls for data.
      </p>
    </div>

    <div id="swagger-ui">Loading...</div>

    <div id="overlay" class="hidden" onclick="javascript:closeModal()"></div>

    <div id="modal" class="hidden">
      <div class="modal-header">
        <h2>Authorizing the API Docs</h2>
      </div>

      <div class="modal-body">
        <p>
          To authenticate, you'll need to request an access token. Run the following command, substituting your "client_id" and "client_secret":
        </p>
<pre>
  curl \
    -H "Content-type: application/json" \
    -d '{"grant_type": "client_credentials", "client_id": "19c1514d-...", "client_secret": "a6af3083..."}' \
    https://auth.sensourceinc.com/oauth/token
</pre>
        <p>
          You will get a response with the access token in it:
        </p>
<pre>
  {
    "access_token":"7a7f1d1256f67e531359f00e6feea254a1d605c5947cd1d3610a01249ccb5acc",
    "refresh_token":"718f6ff90c644866f564df9090dc2f905112c74959a5caf79587c78fd5c04a55",
    "expires_in":3600,
    "token_type":"Bearer"
  }
</pre>
        <p>
          Copy the "access_token" value ("7a7f1d..." in the example). Click the "Authorize" button in the API docs. Then enter in the same thing you'd enter in the "Authorization" header for an API request: the word "Bearer", then a space, then the access_token value:
        </p>

        <p class="center">
          <img src="auth.png" width="439" height="318">
        </p>

        <p>
          You should now be able to make the API calls
        </p>
      </div>
      <div class="modal-footer">
        <button type="button" onclick="javascript:closeModal()">Close</button>
      </div>
    </div>
  </body>

  <script src="//unpkg.com/swagger-ui-dist@3.30.0/swagger-ui-bundle.js"></script>
  <script src="//unpkg.com/swagger-ui-dist@3.30.0/swagger-ui-standalone-preset.js"></script>
  <script src="https://code.jquery.com/jquery-2.2.4.min.js" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script>
  <script src="script.js"></script>
</html>

